"use strict";var e=require("atom"),t=require("event-kit"),o=require("svelte/store"),s=require("svelte/internal"),n=require("svelte");function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var l=a(require("@atxm/developer-console"));class i{constructor(e){this.view=e,this.emitter=new t.Emitter}destroy(){this.emitter.dispose()}hide(){this.view.hide()}show(){this.view.show()}toggle(){this.view.toggle()}stickBottom(){this.view.stickTop=!1}stickTop(){this.view.stickTop=!0}log(e,t="log"){this.view.log(e,t)}error(e){this.log(e,"error")}warn(e){this.log(e,"warning")}info(e){this.log(e,"info")}debug(e){this.log(e,"debug")}raw(e,t="info",o="\n"){e.split(o).map((e=>{this.log(e,t)}))}clear(){this.view.clear()}}var r=o.writable({lines:[],showTimestamp:!0,clear:!1,filters:[]});function c(e=""){const t="console";return e?atom.config.get(`console.${e}`):atom.config.get(t)}function d(){const e=new Date;return{visible:`${`0${e.getHours()}`.slice(-2)}:${`0${e.getMinutes()}`.slice(-2)}:${`0${e.getSeconds()}`.slice(-2)}.${`${e.getMilliseconds()}0`.slice(0,3)}`,tooltip:e.toString()}}function g(e){switch(console.log("mapLevel",e),e){case"debug":return{text:"debug",icon:"icon-bug"};case"error":return{text:"error",icon:"icon-flame"};case"info":return{text:"info",icon:"icon-info"};case"warn":case"warning":return{text:"warning",icon:"icon-issue-opened"};case"raw":return{text:"info",icon:"icon-code"};default:return{text:"highlight",icon:"icon-quote"}}}function p(){return c("wordWrap")?"\n    overflow: hidden;\n    white-space: pre-wrap;\n  ":""}function h(e,t,o){const s=e.slice();return s[10]=t[o].level,s[11]=t[o].message,s[12]=t[o].timestamp,s}function u(e){let t,o=e[11]+"";return{c(){t=s.text(o)},m(e,o){s.insert(e,t,o)},p(e,n){1&n&&o!==(o=e[11]+"")&&s.set_data(t,o)},d(e){e&&s.detach(t)}}}function m(e){let t,o,n,a,l=e[11]+"",i=e[3]&&v(e);return{c(){i&&i.c(),t=s.space(),o=s.element("pre"),n=s.text(l),s.attr(o,"class","message svelte-9ah1eg"),s.attr(o,"style",a=e[2]&&p())},m(e,a){i&&i.m(e,a),s.insert(e,t,a),s.insert(e,o,a),s.append(o,n)},p(e,r){e[3]?i?i.p(e,r):(i=v(e),i.c(),i.m(t.parentNode,t)):i&&(i.d(1),i=null),1&r&&l!==(l=e[11]+"")&&s.set_data(n,l),4&r&&a!==(a=e[2]&&p())&&s.attr(o,"style",a)},d(e){i&&i.d(e),e&&s.detach(t),e&&s.detach(o)}}}function v(e){let t,o,n,a,l,i,r,c,d,p=e[12].visible+"";return{c(){t=s.element("div"),o=s.element("pre"),n=s.element("span"),a=s.text(p),s.attr(n,"title",l=e[12].tooltip),s.attr(o,"class",i="badge "+e[4]+"-"+g(e[10]).text+" icon "+g(e[10]).icon+" svelte-9ah1eg"),s.attr(t,"class",r="timestamp "+g(e[10]).text+" svelte-9ah1eg")},m(l,i){s.insert(l,t,i),s.append(t,o),s.append(o,n),s.append(n,a),c||(d=s.listen(o,"click",e[6]),c=!0)},p(e,c){1&c&&p!==(p=e[12].visible+"")&&s.set_data(a,p),1&c&&l!==(l=e[12].tooltip)&&s.attr(n,"title",l),17&c&&i!==(i="badge "+e[4]+"-"+g(e[10]).text+" icon "+g(e[10]).icon+" svelte-9ah1eg")&&s.attr(o,"class",i),1&c&&r!==(r="timestamp "+g(e[10]).text+" svelte-9ah1eg")&&s.attr(t,"class",r)},d(e){e&&s.detach(t),c=!1,d()}}}function f(e){let t,o,n;function a(e,t){return"string"==typeof e[11]?m:u}let l=a(e),i=l(e);return{c(){t=s.element("p"),i.c(),o=s.space(),t.hidden=n=e[5].length&&!e[5].includes(e[10]),s.attr(t,"class","svelte-9ah1eg")},m(e,n){s.insert(e,t,n),i.m(t,null),s.append(t,o)},p(e,s){l===(l=a(e))&&i?i.p(e,s):(i.d(1),i=l(e),i&&(i.c(),i.m(t,o))),33&s&&n!==(n=e[5].length&&!e[5].includes(e[10]))&&(t.hidden=n)},d(e){e&&s.detach(t),i.d()}}}function b(e){let t,o,n,a,l,i,r,c,d,g,p,u,m,v,b=e[0],w=[];for(let t=0;t<b.length;t+=1)w[t]=f(h(e,b,t));return{c(){t=s.element("div"),o=s.element("div"),n=s.element("button"),n.textContent="Log",a=s.space(),l=s.element("button"),l.textContent="Info",i=s.space(),r=s.element("button"),r.textContent="Warning",c=s.space(),d=s.element("button"),d.textContent="Error",g=s.space(),p=s.element("div"),u=s.element("div");for(let e=0;e<w.length;e+=1)w[e].c();s.attr(n,"class","btn"),s.attr(l,"class","btn"),s.attr(r,"class","btn"),s.attr(d,"class","btn"),s.attr(o,"class","btn-group"),s.attr(t,"class","block"),s.attr(u,"class","console-lines svelte-9ah1eg"),s.attr(u,"tabindex","-1"),s.attr(p,"class","panel-body scrollable svelte-9ah1eg")},m(h,f){s.insert(h,t,f),s.append(t,o),s.append(o,n),s.append(o,a),s.append(o,l),s.append(o,i),s.append(o,r),s.append(o,c),s.append(o,d),s.insert(h,g,f),s.insert(h,p,f),s.append(p,u);for(let e=0;e<w.length;e+=1)w[e].m(u,null);e[8](p),m||(v=[s.listen(n,"click",e[7]),s.listen(l,"click",e[7]),s.listen(r,"click",e[7]),s.listen(d,"click",e[7])],m=!0)},p(e,[t]){if(125&t){let o;for(b=e[0],o=0;o<b.length;o+=1){const s=h(e,b,o);w[o]?w[o].p(s,t):(w[o]=f(s),w[o].c(),w[o].m(u,null))}for(;o<w.length;o+=1)w[o].d(1);w.length=b.length}},i:s.noop,o:s.noop,d(o){o&&s.detach(t),o&&s.detach(g),o&&s.detach(p),s.destroy_each(w,o),e[8](null),m=!1,s.run_all(v)}}}function w(e,t,o){let a;const l=r.subscribe((e=>{switch(e.action){case"log":o(0,a=[...e.lines]);break;case"clear":o(0,a=[])}return a}));let i;n.afterUpdate((()=>{i.scrollTo({left:0,top:i.scrollHeight,behaviour:"smooth"})}));let c,d,g;atom.config.observe("console.wordWrap",(e=>{o(2,c=e)})),atom.config.observe("console.showTimestamp",(e=>{o(3,d=e)})),atom.config.observe("console.coloredBadges",(e=>{o(4,g=e?"badge":"text")}));let p=[];return n.onMount((()=>function(){const e=document.querySelector("status-bar");null!=e&&e.offsetHeight&&document.documentElement.style.setProperty("--status-bar-height",`${e.offsetHeight}px`)}())),n.onDestroy(l),[a,i,c,d,g,p,()=>{i.scrollTo({top:0,left:0,behaviour:"smooth"})},e=>{e.target.classList.toggle("selected");const t=e.target.innerText.toLowerCase();r.update((e=>{if(e.filters.includes(t)){const o=e.filters.indexOf(t);e.filters.splice(o,1)}else e.filters.push(t);return o(5,p=e.filters),e}))},function(e){s.binding_callbacks[e?"unshift":"push"]((()=>{i=e,o(1,i)}))}]}class k extends s.SvelteComponent{constructor(e){var t;super(),document.getElementById("svelte-9ah1eg-style")||((t=s.element("style")).id="svelte-9ah1eg-style",t.textContent=".scrollable.svelte-9ah1eg.svelte-9ah1eg{height:100%;overflow:auto;width:100%}.panel-body.svelte-9ah1eg.svelte-9ah1eg{background-color:var(--inset-panel-background-color);cursor:text;height:100%}.console-lines.svelte-9ah1eg.svelte-9ah1eg{overflow:visible}.console-lines.svelte-9ah1eg.svelte-9ah1eg:empty{padding:0}p.svelte-9ah1eg.svelte-9ah1eg{display:flex;margin:0}p[hidden].svelte-9ah1eg.svelte-9ah1eg{display:none}p.svelte-9ah1eg .timestamp.svelte-9ah1eg{border-left:5px solid;padding:5px;margin-bottom:5px;user-select:none}p.svelte-9ah1eg .timestamp.error.svelte-9ah1eg{border-color:var(--text-color-error)}p.svelte-9ah1eg .timestamp.info.svelte-9ah1eg{border-color:var(--text-color-info)}p.svelte-9ah1eg .timestamp.warning.svelte-9ah1eg{border-color:var(--text-color-warning)}p.svelte-9ah1eg .badge.svelte-9ah1eg{cursor:pointer;font-size:11px;position:sticky;top:5px}p.svelte-9ah1eg .message.svelte-9ah1eg{font-size:unset;flex-grow:1;margin-bottom:var(--status-bar-height)}p.svelte-9ah1eg .message.svelte-9ah1eg::selection{background-color:var(--background-color-selected);color:var(--text-color-selected)}",s.append(document.head,t)),s.init(this,e,w,b,s.safe_not_equal,{})}}var x="console",y=new l.default({name:x,backgroundColor:"mediumorchid"});class C{destroy(){null!==this.disposables&&this.disposables.dispose()}getElement(){const e=document.createElement("console");return new k({target:e}),e}getTitle(){return"Console"}getPath(){return"panel"}getURI(){return`atom://console/${this.getPath()}`}getDefaultLocation(){return c("panelLocation")}show(){atom.workspace.open(this,{activatePane:!1}),function(){switch(c("panelLocation").toLowerCase()){case"left":atom.workspace.getLeftDock().show();break;case"right":atom.workspace.getRightDock().show();break;default:atom.workspace.getBottomDock().show()}}()}hide(){!function(){switch(c("panelLocation").toLowerCase()){case"left":atom.workspace.getLeftDock().hide();break;case"right":atom.workspace.getRightDock().hide();break;default:atom.workspace.getBottomDock().hide()}}()}toggle(){atom.workspace.toggle(this)}log(e,t){r.update((o=>(o.lines=[...o.lines||[],{level:t,message:e,timestamp:d()}],o.action="log",o)))}clear(){y.log("Clearing console"),r.update((e=>(e.action="clear",e.lines=[],e)))}}var L={config:{showTimestamp:{description:"Displays a timestamp next to the output",type:"boolean",default:!0,order:1},coloredBadges:{description:"Colors background of the timestamp badge",type:"boolean",default:!1,order:2},wordWrap:{description:"Wrap words if the line length exceeds the panel width",type:"boolean",default:!0,order:3},panelLocation:{title:"Panel Location",description:"Specifies the panel location. The change will only take effect on the next launch.",type:"string",order:4,enum:[{value:"bottom",description:"bottom"},{value:"left",description:"left"},{value:"right",description:"right"}],default:"bottom"}},consoleView:null,subscriptions:null,activate(){y.log("Activating package"),this.consoleView=new C,this.consoleManager=new i(this.consoleView),this.subscriptions=new e.CompositeDisposable,this.subscriptions.add(atom.commands.add("atom-workspace",{"console:show":()=>this.consoleManager.show()})),this.subscriptions.add(atom.commands.add("atom-workspace",{"console:hide":()=>this.consoleManager.hide()})),this.subscriptions.add(atom.commands.add("atom-workspace",{"console:toggle":()=>this.consoleManager.toggle()})),this.subscriptions.add(atom.commands.add("atom-workspace",{"console:clear":()=>this.consoleManager.clear()})),atom.inDevMode()&&(window.cp=this.consoleManager,atom.commands.add("atom-workspace",{"console:log":()=>this.consoleManager.raw({msg:"Hello World"})}))},deactivate(){y.log("Deactivating package"),this.subscriptions.dispose(),this.consoleView.destroy()},provideConsole(){return y.log("Providing service"),this.consoleManager}};module.exports=L;
//# sourceMappingURL=console.js.map
